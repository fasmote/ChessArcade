# üìã ERS - Master Sequence

**Especificaci√≥n de Requerimientos de Software**

---

## üìä INFORMACI√ìN DEL DOCUMENTO

| Campo | Valor |
|-------|-------|
| **Proyecto** | Master Sequence - ChessArcade |
| **Versi√≥n** | 2.0.0 |
| **Fecha** | 19 de Octubre, 2025 |
| **Autor** | ChessArcade Team |
| **Estado** | ‚úÖ En Producci√≥n |
| **√öltima Actualizaci√≥n** | 19/10/2025 - Sistema HINT completo implementado |

---

## üìë TABLA DE CONTENIDOS

1. [Introducci√≥n](#1-introducci√≥n)
2. [Alcance del Proyecto](#2-alcance-del-proyecto)
3. [Descripci√≥n General](#3-descripci√≥n-general)
4. [Requerimientos Funcionales](#4-requerimientos-funcionales)
5. [Requerimientos No Funcionales](#5-requerimientos-no-funcionales)
6. [Casos de Uso](#6-casos-de-uso)
7. [Reglas de Negocio](#7-reglas-de-negocio)
8. [Interfaz de Usuario](#8-interfaz-de-usuario)
9. [Modelo de Datos](#9-modelo-de-datos)
10. [Matriz de Trazabilidad](#10-matriz-de-trazabilidad)
11. [Criterios de Aceptaci√≥n](#11-criterios-de-aceptaci√≥n)
12. [Mejoras Futuras](#12-mejoras-futuras)
13. [Glosario](#13-glosario)

---

## 1. INTRODUCCI√ìN

### 1.1 Prop√≥sito

Este documento especifica los requerimientos funcionales y no funcionales del juego **Master Sequence**, un juego de memoria basado en la mec√°nica de "Simon Says" aplicada sobre un tablero de ajedrez con est√©tica ne√≥n retro-futurista.

### 1.2 Audiencia

- **Analistas Funcionales**: Entender reglas de negocio y flujos del juego
- **Desarrolladores**: Implementar funcionalidades seg√∫n especificaciones
- **QA/Testers**: Validar funcionalidad y crear casos de prueba
- **Stakeholders/Cliente**: Revisar y aprobar funcionalidades
- **Dise√±adores UX/UI**: Comprender experiencia esperada del usuario

### 1.3 Referencias

- Documento de Dise√±o: `DESIGN.md`
- Changelog: `CHANGELOG.md`
- Mejoras Planificadas: `MEJORAS_PLANIFICADAS.md`
- C√≥digo fuente: `game.js`, `levels.js`, `audio.js`

---

## 2. ALCANCE DEL PROYECTO

### 2.1 Objetivos

1. **Entrenamiento de Memoria**: Mejorar memoria secuencial y visualizaci√≥n espacial
2. **Aprendizaje de Coordenadas**: Familiarizar con notaci√≥n algebraica del ajedrez
3. **Experiencia Gamificada**: Sistema de puntuaci√≥n, rachas y records
4. **Accesibilidad**: Funcional en desktop y mobile sin instalaci√≥n

### 2.2 L√≠mites del Sistema

**Incluido:**
- ‚úÖ Modo de juego single-player
- ‚úÖ 10 niveles predefinidos + modo infinito
- ‚úÖ Sistema de vidas (5 vidas)
- ‚úÖ Sistema de puntuaci√≥n avanzado (speed bonus, perfect streaks)
- ‚úÖ Persistencia de high scores (localStorage)
- ‚úÖ Audio sint√©tico (Web Audio API)
- ‚úÖ Responsive design (mobile + desktop)
- ‚úÖ Toggle de coordenadas y sonido
- ‚úÖ Sistema HINT visual avanzado (v2.0):
  - Coordenadas ne√≥n en casillas de secuencia
  - Flechas direccionales grandes y pulsantes
  - L√≠neas conectoras negras entre casillas
  - S√≠mbolo de repetici√≥n (‚ü≤) para casillas duplicadas
  - Borde amarillo pulsante en siguiente casilla
  - Costo: -100 pts y p√©rdida de racha perfecta
  - Validaci√≥n: requiere score >= 100 pts

**No Incluido (fuera de alcance v2.0):**
- ‚ùå Multiplayer / modo competitivo
- ‚ùå Servidor backend / base de datos
- ‚ùå Sistema de cuentas de usuario
- ‚ùå Leaderboard global
- ‚ùå Monetizaci√≥n / compras in-app
- ‚ùå Modo offline con PWA

---

## 3. DESCRIPCI√ìN GENERAL

### 3.1 Concepto del Juego

**Master Sequence** es un juego de memoria tipo "Simon Says" donde:
1. El sistema muestra una secuencia de casillas iluminadas en un tablero de ajedrez
2. Cada casilla tiene un color ne√≥n √∫nico
3. El jugador debe repetir la secuencia en el mismo orden
4. La secuencia es **acumulativa**: cada nivel agrega una casilla m√°s
5. Los movimientos siguen patrones de **rey o caballo** del ajedrez

### 3.2 Flujo Principal del Juego

```
[Pantalla Principal]
      ‚Üì
[Presiona PLAY/COMENZAR]
      ‚Üì
[Nivel N: Mostrar Secuencia]
      ‚Üì
[Jugador Repite Secuencia]
      ‚Üì
   ¬øCorrecto?
      ‚îú‚îÄ S√ç ‚Üí [Nivel N+1] (loop)
      ‚îî‚îÄ NO ‚Üí [Pierde 1 vida]
               ‚Üì
            ¬øVidas > 0?
               ‚îú‚îÄ S√ç ‚Üí [Reintentar mismo nivel]
               ‚îî‚îÄ NO ‚Üí [Game Over]
```

---

## 4. REQUERIMIENTOS FUNCIONALES

### RF-001: Generaci√≥n de Secuencia Acumulativa

**Prioridad:** Alta
**M√≥dulo:** Generaci√≥n de Niveles

**Descripci√≥n:**
El sistema debe generar una secuencia acumulativa de casillas que crece en cada nivel.

**Criterios:**
- Nivel 1: 1 casilla
- Nivel 2: 2 casillas (la del nivel 1 + 1 nueva)
- Nivel N: N casillas
- Cada nueva casilla debe ser alcanzable desde la anterior mediante movimiento de **rey** (1 casilla adyacente) o **caballo** (movimiento en L)

**Reglas de Negocio:**
- RN-001: M√°ximo 2 usos por casilla en toda la partida
- RN-002: Movimientos v√°lidos seg√∫n patr√≥n rey/caballo
- RN-003: √Årea restringida seg√∫n configuraci√≥n del nivel

**Tests:**
```
TC-001: Nivel 1 genera 1 casilla
TC-002: Nivel 5 genera 5 casillas acumulativas
TC-003: Nueva casilla es alcanzable desde la anterior
TC-004: Casilla no se usa m√°s de 2 veces en toda la partida
```

---

### RF-002: Visualizaci√≥n de Secuencia

**Prioridad:** Alta
**M√≥dulo:** Interfaz de Usuario

**Descripci√≥n:**
El sistema debe mostrar la secuencia de casillas con efectos visuales y auditivos.

**Criterios:**
- Cada casilla se ilumina con un color ne√≥n espec√≠fico
- Duraci√≥n de highlight configurable por nivel
- Pausa entre casillas configurable por nivel
- Sonido beep sincronizado con highlight
- No se permite interacci√≥n durante la visualizaci√≥n

**Colores Disponibles:**
1. Cyan (#00ffff)
2. Magenta (#ff0080)
3. Green (#00ff80)
4. Orange (#ff8000)
5. Purple (#8000ff)
6. Yellow (#ffff00)
7. Pink (#ff0040)
8. Lime (#80ff00)

**Tests:**
```
TC-005: Secuencia se muestra completa sin interrupciones
TC-006: Cada casilla tiene color √∫nico asignado
TC-007: Sonido se reproduce sincronizado con visual
TC-008: Tablero est√° deshabilitado durante visualizaci√≥n
```

---

### RF-003: Entrada del Jugador

**Prioridad:** Alta
**M√≥dulo:** Interacci√≥n

**Descripci√≥n:**
El jugador debe poder hacer clic en las casillas para reproducir la secuencia.

**Criterios:**
- Click en casilla registra la entrada
- Feedback visual inmediato (highlight con mismo color)
- Validaci√≥n en tiempo real contra secuencia esperada
- Contador de progreso visible (X/N completadas)

**Flujo:**
```
1. Jugador hace click en casilla
2. Sistema valida si es la casilla correcta en el orden
3. SI es correcta:
   - Ilumina con el color original
   - Reproduce sonido de √©xito
   - Incrementa contador
4. SI es incorrecta:
   - Ilumina en rojo
   - Reproduce sonido de error
   - Pierde 1 vida
   - Muestra overlay de fallo
```

**Tests:**
```
TC-009: Click en casilla correcta avanza progreso
TC-010: Click en casilla incorrecta resta vida
TC-011: Completar secuencia dispara evento de nivel completado
TC-012: No se puede hacer click durante visualizaci√≥n
```

---

### RF-004: Sistema de Vidas

**Prioridad:** Alta
**M√≥dulo:** Gesti√≥n de Estado

**Descripci√≥n:**
El jugador tiene 5 vidas. Al perder todas, termina el juego.

**Criterios:**
- Jugador inicia con 5 vidas (‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è)
- Cada error resta 1 vida
- Vidas se muestran como corazones en UI
- Game Over cuando vidas = 0

**Estados de Vida:**
- 5 vidas: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è
- 3 vidas: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏èüñ§üñ§
- 1 vida: ‚ù§Ô∏èüñ§üñ§üñ§üñ§
- 0 vidas: üñ§üñ§üñ§üñ§üñ§ ‚Üí Game Over

**Tests:**
```
TC-013: Jugador inicia con 5 vidas
TC-014: Error resta 1 vida
TC-015: Perder √∫ltima vida dispara Game Over
TC-016: Vidas se actualizan en UI correctamente
```

---

### RF-005: Sistema de Puntuaci√≥n Avanzado

**Prioridad:** Media
**M√≥dulo:** Scoring

**Descripci√≥n:**
Sistema de puntuaci√≥n con bonus por velocidad y rachas perfectas.

**F√≥rmula:**
```
Puntos Finales = (Puntos Base + Speed Bonus) √ó Streak Multiplier

Puntos Base:
- Nivel N perfecto: N √ó 15 pts
- Nivel N con errores: N √ó 10 pts

Speed Bonus:
- < 50% tiempo recomendado: +100 pts
- < 75% tiempo recomendado: +50 pts
- < 100% tiempo recomendado: +25 pts
- > 100%: 0 pts

Streak Multiplier:
- 3-4 perfectos: x1.5
- 5-9 perfectos: x2.0
- 10+ perfectos: x3.0
```

**Tiempo Recomendado:**
```javascript
T_rec = 2000ms + (sequenceLength √ó 1500ms)
```

**Tests:**
```
TC-017: Puntos base calculados correctamente
TC-018: Speed bonus aplicado seg√∫n tiempo
TC-019: Streak multiplier se aplica correctamente
TC-020: F√≥rmula completa calcula puntos finales
```

---

### RF-006: Perfect Streak (Rachas Perfectas)

**Prioridad:** Media
**M√≥dulo:** Scoring

**Descripci√≥n:**
Contador de niveles completados sin errores consecutivos.

**Criterios:**
- Incrementa en 1 si nivel completado sin errores (first try)
- Resetea a 0 si comete alg√∫n error
- Visible en UI solo si streak ‚â• 3
- Aplica multiplicador a puntos

**Visualizaci√≥n:**
- 3 perfectos: "3üî•" (Multiplier x1.5)
- 5 perfectos: "5üî•" (Multiplier x2.0)
- 10 perfectos: "10üî•" (Multiplier x3.0)

**Tests:**
```
TC-021: Streak incrementa en nivel perfecto
TC-022: Streak resetea en error
TC-023: Stat visible solo si ‚â• 3
TC-024: Multiplicador se aplica correctamente
```

---

### RF-007: High Scores (Persistencia)

**Prioridad:** Media
**M√≥dulo:** Almacenamiento

**Descripci√≥n:**
Guardar mejores marcas del jugador en localStorage.

**Datos Persistidos:**
```javascript
{
  topScore: 0,              // Mejor puntuaci√≥n hist√≥rica
  bestLevel: 1,             // Nivel m√°ximo alcanzado
  longestStreak: 0,         // Racha perfecta m√°s larga
  fastestLevel: {           // Nivel m√°s r√°pido
    level: 1,
    time: 999999
  },
  lastUpdated: timestamp    // √öltima actualizaci√≥n
}
```

**Key localStorage:** `masterSequence_highScores`

**Tests:**
```
TC-025: High scores se guardan en localStorage
TC-026: High scores se cargan al iniciar
TC-027: Nuevo record actualiza y guarda
TC-028: Resetear high scores funciona
```

---

### RF-008: Toggle de Coordenadas

**Prioridad:** Baja
**M√≥dulo:** Ayudas Visuales

**Descripci√≥n:**
Bot√≥n para mostrar/ocultar coordenadas dentro de las casillas.

**Criterios:**
- Bot√≥n "SHOW COORDINATES" / "HIDE COORDINATES"
- Mobile: Bot√≥n naranja arriba del tablero
- Desktop: En sidebar p√∫rpura
- Estado persiste en localStorage
- Coordenadas con fondo oscuro + glow ne√≥n

**Key localStorage:** `coordinate_sequence_coordinates`

**Tests:**
```
TC-029: Toggle muestra/oculta coordenadas
TC-030: Estado persiste entre sesiones
TC-031: Bot√≥n cambia texto seg√∫n estado
TC-032: Coordenadas legibles en todas las casillas
```

---

### RF-009: Toggle de Sonido

**Prioridad:** Baja
**M√≥dulo:** Audio

**Descripci√≥n:**
Bot√≥n para activar/desactivar efectos de sonido.

**Criterios:**
- Bot√≥n en header con icono de speaker
- Estados: ON (ondas visibles) / OFF (X sobre speaker)
- Estado persiste en localStorage
- Afecta todos los sonidos del juego

**Sonidos del Sistema:**
- Beep durante secuencia
- Sonido de √©xito (correct)
- Sonido de error (incorrect)
- Sonido de nivel completado
- Sonido de game over

**Key localStorage:** `coordinate_sequence_sound`

**Tests:**
```
TC-033: Toggle activa/desactiva sonidos
TC-034: Estado persiste entre sesiones
TC-035: Icono cambia seg√∫n estado
TC-036: Sonidos no se reproducen cuando OFF
```

---

### RF-010: Overlays de Estado

**Prioridad:** Alta
**M√≥dulo:** UI

**Descripci√≥n:**
Pantallas modales para comunicar estados del juego.

**Overlays Requeridos:**

#### 1. Success (Nivel Completado - No Modal)
- Sin overlay disruptivo
- Confeti ne√≥n (30 part√≠culas)
- Sonido de victoria
- Auto-avance a siguiente nivel (1.5s)

#### 2. Fail Overlay (Error)
- Icono: ‚ùå
- T√≠tulo: "¬°Secuencia Incorrecta!"
- Mensaje: "Te quedan X vidas"
- Secuencia correcta mostrada
- Bot√≥n: "üîÑ Reintentar"

#### 3. Game Over Overlay
- Icono: üíÄ
- T√≠tulo: "Game Over"
- Stats finales: Nivel alcanzado, Score total
- Botones:
  - "üîÑ Jugar de Nuevo" (reinicia autom√°ticamente)
  - "üè† Volver al Inicio" (vuelve a pantalla principal sin empezar)

**Tests:**
```
TC-037: Confeti aparece al completar nivel
TC-038: Fail overlay muestra vidas restantes
TC-039: Game Over muestra stats finales
TC-040: Botones de overlays ejecutan acci√≥n correcta
```

---

### RF-011: Responsive Design

**Prioridad:** Alta
**M√≥dulo:** UI/Layout

**Descripci√≥n:**
Juego funcional en diferentes tama√±os de pantalla.

**Breakpoints:**
- **Mobile**: < 900px
- **Desktop**: ‚â• 900px

**Layout Mobile:**
```
[Header - Botones en l√≠nea]
[T√≠tulo + Logo]
[Stats: Vidas | Longitud | Score | Best]
[Bot√≥n Coordenadas (naranja)]
[Tablero Centrado]
[Status Message]
[How to Play]
```

**Layout Desktop:**
```
[Header - Botones en l√≠nea]
[T√≠tulo + Logo]
[Stats: Vidas | Longitud | Score | Racha | Best]
[Wrapper Centrado]
  [Tablero (centro)] [Sidebar P√∫rpura (derecha)]
[Status Message]
[How to Play]
```

**Tests:**
```
TC-041: Layout mobile se muestra correctamente
TC-042: Layout desktop se muestra correctamente
TC-043: Tablero centrado en ambos tama√±os
TC-044: Botones accesibles en mobile
```

---

### RF-012: Configuraci√≥n de Niveles

**Prioridad:** Alta
**M√≥dulo:** Niveles

**Descripci√≥n:**
Sistema configurable de niveles con dificultad progresiva.

**Par√°metros por Nivel:**
```javascript
{
  sequenceLength: 3,        // Casillas a agregar
  restrictedArea: 'ring',   // √Årea permitida
  highlightDuration: 600,   // ms de highlight
  pauseDuration: 400,       // ms entre casillas
  useColors: true           // Usar colores ne√≥n
}
```

**Tipos de √Åreas Restringidas:**
- `ring`: Anillo de NxN casillas desde el centro
- `quadrant`: Cuadrante del tablero
- `rows`: Filas espec√≠ficas
- `files`: Columnas espec√≠ficas
- `all`: Tablero completo (64 casillas)

**Niveles Predefinidos:** 10 niveles
**Modo Infinito:** Nivel 11+

**Tests:**
```
TC-045: Nivel 1 tiene configuraci√≥n correcta
TC-046: Dificultad incrementa progresivamente
TC-047: Modo infinito funciona despu√©s de nivel 10
TC-048: √Årea restringida se aplica correctamente
```

---

## 5. REQUERIMIENTOS NO FUNCIONALES

### RNF-001: Rendimiento

**Criterio:** Animaciones a 60fps sin drops

**M√©tricas:**
- Tiempo de carga inicial: < 2s
- Respuesta a click: < 50ms
- Animaci√≥n de highlight: smooth 60fps
- Transiciones de overlay: < 300ms

**Tests:**
```
TNF-001: Lighthouse Performance Score > 90
TNF-002: No frame drops durante animaciones
TNF-003: Click response time < 50ms
```

---

### RNF-002: Compatibilidad

**Navegadores Soportados:**
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

**Dispositivos:**
- Desktop: 1280x720 m√≠nimo
- Tablet: 768x1024
- Mobile: 375x667 m√≠nimo

**Tests:**
```
TNF-004: Funciona en Chrome latest
TNF-005: Funciona en Firefox latest
TNF-006: Funciona en Safari iOS
TNF-007: Funciona en mobile Android
```

---

### RNF-003: Accesibilidad

**Criterios:**
- Contraste m√≠nimo: WCAG AA (4.5:1)
- Navegaci√≥n por teclado: Soportada
- Screen readers: ARIA labels
- Colores no son √∫nica forma de informaci√≥n

**Tests:**
```
TNF-008: Contraste pasa WCAG AA
TNF-009: Navegable con teclado
TNF-010: ARIA labels presentes
```

---

### RNF-004: Usabilidad

**Criterios:**
- Feedback inmediato a todas las acciones
- Tiempo de aprendizaje: < 2 minutos
- Mensajes de error claros
- Ayuda contextual disponible

**Tests:**
```
TNF-011: Usuario nuevo completa nivel 1 sin ayuda
TNF-012: Mensajes de error son comprensibles
TNF-013: Tutorial es suficiente para empezar
```

---

### RNF-005: Mantenibilidad

**Criterios:**
- C√≥digo modular y documentado
- Separaci√≥n de responsabilidades
- Nombres de variables descriptivos
- Funciones < 50 l√≠neas

**Estructura:**
```
game.js       - L√≥gica principal
levels.js     - Configuraci√≥n de niveles
audio.js      - Sistema de audio
styles.css    - Estilos y animaciones
```

---

## 6. CASOS DE USO

### CU-001: Iniciar Juego

**Actor:** Jugador
**Precondici√≥n:** Usuario est√° en la pantalla principal
**Postcondici√≥n:** Nivel 1 inicia y muestra primera secuencia

**Flujo Principal:**
1. Usuario hace clic en bot√≥n "COMENZAR" o bot√≥n PLAY central
2. Sistema oculta bot√≥n PLAY
3. Sistema genera secuencia inicial (1 casilla)
4. Sistema muestra secuencia con efectos visuales/sonoros
5. Sistema habilita tablero para entrada del jugador
6. Sistema actualiza mensaje de estado: "¬°Ahora repite la secuencia!"

**Flujos Alternativos:**
- FA-001: Si ya hay un juego en curso, confirmar reinicio

**Criterios de Aceptaci√≥n:**
- ‚úÖ Secuencia se muestra completa
- ‚úÖ Tablero est√° habilitado despu√©s de visualizaci√≥n
- ‚úÖ Stats iniciales visibles (5‚ù§Ô∏è, Longitud: 1, Score: 0)

---

### CU-002: Completar Nivel Perfectamente

**Actor:** Jugador
**Precondici√≥n:** Secuencia mostrada, tablero habilitado
**Postcondici√≥n:** Avanza al siguiente nivel

**Flujo Principal:**
1. Jugador hace clic en las casillas en el orden correcto
2. Sistema valida cada casilla
3. Sistema ilumina con color original si es correcta
4. Sistema incrementa contador de progreso
5. Al completar toda la secuencia:
   - Calcula puntos (base + speed bonus)
   - Incrementa perfect streak
   - Aplica streak multiplier
   - Actualiza high scores si corresponde
   - Muestra confeti
   - Reproduce sonido de victoria
6. Despu√©s de 1.5s, avanza al siguiente nivel autom√°ticamente

**Flujos Alternativos:**
- FA-002: Si es nuevo record, mostrar mensaje especial en consola

**Criterios de Aceptaci√≥n:**
- ‚úÖ Puntos calculados correctamente
- ‚úÖ Perfect streak incrementado
- ‚úÖ High scores actualizados si aplica
- ‚úÖ Siguiente nivel se carga autom√°ticamente

---

### CU-003: Cometer Error

**Actor:** Jugador
**Precondici√≥n:** Secuencia mostrada, tablero habilitado
**Postcondici√≥n:** Pierde 1 vida, puede reintentar

**Flujo Principal:**
1. Jugador hace clic en casilla incorrecta
2. Sistema ilumina casilla en rojo
3. Sistema reproduce sonido de error
4. Sistema resta 1 vida
5. Sistema resetea perfect streak a 0
6. Sistema deshabilita tablero
7. Sistema muestra overlay de error con:
   - Vidas restantes
   - Secuencia correcta
   - Bot√≥n "Reintentar"
8. Usuario hace clic en "Reintentar"
9. Sistema oculta overlay
10. Sistema muestra secuencia nuevamente

**Flujos Alternativos:**
- FA-003: Si vidas = 0, ir a Game Over (CU-004)

**Criterios de Aceptaci√≥n:**
- ‚úÖ Vida se resta correctamente
- ‚úÖ Perfect streak reseteado
- ‚úÖ Overlay muestra informaci√≥n correcta
- ‚úÖ Reintentar funciona correctamente

---

### CU-004: Game Over

**Actor:** Jugador
**Precondici√≥n:** Vidas = 0
**Postcondici√≥n:** Juego termina, muestra estad√≠sticas finales

**Flujo Principal:**
1. Sistema detecta vidas = 0
2. Sistema deshabilita tablero
3. Sistema reproduce sonido de game over
4. Sistema muestra overlay de Game Over con:
   - Nivel alcanzado
   - Score total
   - Bot√≥n "Jugar de Nuevo"
   - Bot√≥n "Volver al Inicio"
5. Usuario elige una opci√≥n

**Flujo Alternativo A - Jugar de Nuevo:**
1. Sistema oculta overlay
2. Sistema reinicia juego autom√°ticamente (CU-001)

**Flujo Alternativo B - Volver al Inicio:**
1. Sistema oculta overlay
2. Sistema resetea estado a valores iniciales
3. Sistema muestra bot√≥n PLAY
4. Sistema NO inicia juego (usuario decide cu√°ndo)
5. Usuario puede:
   - Leer instrucciones
   - Ver sus high scores
   - Decidir cu√°ndo empezar nuevo juego

**Criterios de Aceptaci√≥n:**
- ‚úÖ Stats finales correctas
- ‚úÖ Ambos botones funcionan correctamente
- ‚úÖ "Jugar de Nuevo" reinicia autom√°ticamente
- ‚úÖ "Volver al Inicio" NO inicia autom√°ticamente

---

### CU-005: Ver High Scores

**Actor:** Jugador
**Precondici√≥n:** Juego cargado
**Postcondici√≥n:** Usuario ve sus mejores marcas

**Flujo Principal (v1.2):**
1. Sistema carga high scores de localStorage al iniciar
2. "BEST" score visible en stats permanentemente
3. Perfect streak visible si ‚â• 3
4. Logs en consola cuando rompe record

**Flujo Futuro (v2.0):**
1. Usuario hace clic en bot√≥n "STATS"
2. Sistema abre overlay con todos los records
3. Usuario puede ver todos sus logros
4. Usuario puede resetear stats

**Criterios de Aceptaci√≥n:**
- ‚úÖ High scores se cargan al iniciar
- ‚úÖ BEST score visible en UI
- ‚úÖ Records persisten entre sesiones

---

### CU-006: Toggle Coordenadas

**Actor:** Jugador
**Precondici√≥n:** Juego iniciado
**Postcondici√≥n:** Coordenadas mostradas/ocultas

**Flujo Principal:**
1. Usuario hace clic en bot√≥n "SHOW COORDINATES"
2. Sistema muestra coordenadas dentro de todas las casillas
3. Sistema cambia texto a "HIDE COORDINATES"
4. Sistema guarda preferencia en localStorage
5. Usuario hace clic nuevamente
6. Sistema oculta coordenadas
7. Sistema cambia texto a "SHOW COORDINATES"

**Criterios de Aceptaci√≥n:**
- ‚úÖ Coordenadas se muestran/ocultan correctamente
- ‚úÖ Bot√≥n cambia texto seg√∫n estado
- ‚úÖ Preferencia persiste entre sesiones

---

### CU-007: Toggle Sonido

**Actor:** Jugador
**Precondici√≥n:** Juego cargado
**Postcondici√≥n:** Sonidos activados/desactivados

**Flujo Principal:**
1. Usuario hace clic en bot√≥n de sonido
2. Sistema cambia estado de sonido
3. Sistema actualiza icono (speaker con/sin X)
4. Sistema guarda preferencia en localStorage
5. Sonidos se reproducen o no seg√∫n estado

**Criterios de Aceptaci√≥n:**
- ‚úÖ Sonidos se activan/desactivan correctamente
- ‚úÖ Icono refleja estado actual
- ‚úÖ Preferencia persiste entre sesiones

---

## 7. REGLAS DE NEGOCIO

### RN-001: L√≠mite de Uso por Casilla

**Descripci√≥n:** Ninguna casilla puede aparecer m√°s de 2 veces en toda la partida.

**Justificaci√≥n:** Evitar monoton√≠a y aprovechar todo el tablero.

**Implementaci√≥n:**
```javascript
squareUsageCount[square] <= 2
```

**Excepci√≥n:** Ninguna

---

### RN-002: Movimientos V√°lidos

**Descripci√≥n:** Cada nueva casilla debe ser alcanzable desde la anterior mediante movimiento de rey o caballo.

**Movimiento Rey:**
- 1 casilla en cualquier direcci√≥n (8 opciones)
- Distancia Chebyshev = 1

**Movimiento Caballo:**
- Movimiento en L (8 posiciones posibles)
- (¬±1, ¬±2) o (¬±2, ¬±1)

**Implementaci√≥n:**
```javascript
isKingMove(from, to) || isKnightMove(from, to)
```

---

### RN-003: √Årea Restringida

**Descripci√≥n:** Nuevas casillas deben estar dentro del √°rea permitida por el nivel.

**Tipos de √Årea:**
- Ring: Anillo desde el centro
- Quadrant: Cuadrante espec√≠fico
- Rows: Filas espec√≠ficas
- Files: Columnas espec√≠ficas
- All: Sin restricci√≥n

**Implementaci√≥n:**
```javascript
isWithinArea(square, areaConfig)
```

---

### RN-004: C√°lculo de Puntos Base

**Descripci√≥n:** Puntos dependen del nivel y si fue perfecto.

**F√≥rmula:**
```
Perfecto: nivel √ó 15
Con errores: nivel √ó 10
```

**Ejemplo:**
- Nivel 5 perfecto: 75 pts
- Nivel 5 con error: 50 pts

---

### RN-005: Speed Bonus

**Descripci√≥n:** Bonus por completar nivel r√°pido.

**Rangos:**
```
< 50% tiempo: +100 pts
< 75% tiempo: +50 pts
< 100% tiempo: +25 pts
> 100%: 0 pts
```

**Tiempo Recomendado:**
```
T = 2s + (longitud_secuencia √ó 1.5s)
```

---

### RN-006: Streak Multiplier

**Descripci√≥n:** Multiplicador por niveles perfectos consecutivos.

**Tabla:**
| Streak | Multiplier |
|--------|------------|
| 0-2    | x1.0       |
| 3-4    | x1.5       |
| 5-9    | x2.0       |
| 10+    | x3.0       |

**Reset:** Al cometer cualquier error

---

### RN-007: High Scores

**Descripci√≥n:** Se guarda el mejor valor de cada categor√≠a.

**Categor√≠as:**
1. Top Score (puntuaci√≥n m√°s alta)
2. Best Level (nivel m√°ximo alcanzado)
3. Longest Streak (racha perfecta m√°s larga)
4. Fastest Level (nivel completado m√°s r√°pido)

**Actualizaci√≥n:** Solo si nuevo valor > valor guardado

---

### RN-008: Persistencia

**Descripci√≥n:** Datos que persisten entre sesiones.

**Datos Persistidos:**
- High scores (masterSequence_highScores)
- Preferencia de sonido (coordinate_sequence_sound)
- Preferencia de coordenadas (coordinate_sequence_coordinates)

**Storage:** localStorage

---

## 8. INTERFAZ DE USUARIO

### 8.1 Componentes Principales

#### Header
```
[üè† HOME] [‚ñ∂ COMENZAR] [üîä SONIDO]
```

#### T√≠tulo
```
[üü™üü®üü¶ Master Sequence]
Watch, remember, repeat. Master the pattern!
```

#### Stats
```
Mobile:
[VIDAS: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è] [LONGITUD: 8] [SCORE: 1443] [BEST: 1443]

Desktop:
[VIDAS: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è] [LONGITUD: 8] [SCORE: 1443] [RACHA: 7üî•] [BEST: 1443]
```

#### Tablero
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  8x8 Chessboard ‚îÇ
‚îÇ  64 squares     ‚îÇ
‚îÇ  Neon colors    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Status Message
```
[Presiona COMENZAR para iniciar]
[¬°Ahora repite la secuencia!]
```

---

### 8.2 Paleta de Colores

**Colores Primarios:**
```css
--neon-cyan: #00ffff
--neon-magenta: #ff0080
--neon-green: #00ff80
--neon-orange: #ff8000
--neon-purple: #8000ff
--neon-yellow: #ffff00
--neon-pink: #ff0040
--neon-lime: #80ff00
```

**Colores UI:**
```css
--bg-dark: #0a0a0a
--text-light: #ffffff
--border-glow: rgba(0, 255, 255, 0.5)
```

---

### 8.3 Tipograf√≠a

**Fuente Principal:** Orbitron (Google Fonts)
- T√≠tulos: 900 weight
- Labels: 700 weight
- Texto: 400 weight

**Tama√±os:**
- H1: clamp(1.5rem, 5vw, 3rem)
- Stats: clamp(1rem, 3vw, 1.5rem)
- Botones: 1rem

---

### 8.4 Animaciones

**Highlight Casilla:**
```css
Duration: 600ms (level dependent)
Effect: Scale + Glow + Color change
Easing: ease-in-out
```

**Confeti:**
```css
Particles: 30
Duration: 2s
Colors: All neon colors
Animation: Fall + rotate + fade
```

**Perfect Streak Badge:**
```css
Appearance: Slide in from top
Color: Fire gradient
Effect: Pulse on increment
```

---

## 9. MODELO DE DATOS

### 9.1 Estado del Juego (gameState)

```javascript
{
  // Progresi√≥n
  currentLevel: 1,              // Nivel actual
  score: 0,                     // Puntuaci√≥n acumulada
  lives: 5,                     // Vidas restantes
  maxLives: 5,                  // Vidas m√°ximas

  // Secuencia Acumulativa
  masterSequence: [],           // ['d4', 'd5', 'e5', ...]
  sequenceColors: [],           // [colorCyan, colorMagenta, ...]
  squareUsageCount: {},         // { 'd4': 2, 'd5': 1, ... }
  sequence: [],                 // Copia de masterSequence
  playerSequence: [],           // Input del jugador
  currentStep: 0,               // Paso actual en reproducci√≥n

  // Fase
  phase: 'idle',                // idle | showing | playing | success | fail | gameover

  // Configuraci√≥n
  soundEnabled: true,           // Toggle sonido
  coordinatesEnabled: false,    // Toggle coordenadas

  // Estad√≠sticas
  bestLevel: 1,                 // Mejor nivel en sesi√≥n actual
  totalAttempts: 0,             // Intentos totales
  perfectLevels: 0,             // Niveles perfectos totales
  currentLevelAttempts: 0,      // Intentos del nivel actual

  // Sistema de Puntuaci√≥n
  levelStartTime: 0,            // Timestamp inicio nivel
  levelEndTime: 0,              // Timestamp fin nivel
  perfectStreak: 0,             // Racha perfecta actual

  // High Scores (persistido)
  highScores: {
    topScore: 0,
    bestLevel: 1,
    longestStreak: 0,
    fastestLevel: {
      level: 1,
      time: 999999
    },
    lastUpdated: null
  }
}
```

---

### 9.2 Configuraci√≥n de Nivel (levelConfig)

```javascript
{
  sequenceLength: 3,            // Casillas a agregar
  restrictedArea: {             // √Årea permitida
    type: 'ring',               // ring | quadrant | rows | files | all
    size: 4,                    // Tama√±o del √°rea
    params: {}                  // Par√°metros espec√≠ficos
  },
  highlightDuration: 600,       // ms de highlight
  pauseDuration: 400,           // ms entre casillas
  useColors: true               // Usar colores ne√≥n
}
```

---

### 9.3 Estructura localStorage

**Key:** `masterSequence_highScores`

```json
{
  "topScore": 1443,
  "bestLevel": 7,
  "longestStreak": 7,
  "fastestLevel": {
    "level": 3,
    "time": 1430
  },
  "lastUpdated": 1729123456789
}
```

**Key:** `coordinate_sequence_sound`
```
Value: "enabled" | "disabled"
```

**Key:** `coordinate_sequence_coordinates`
```
Value: "enabled" | "disabled"
```

---

## 10. MATRIZ DE TRAZABILIDAD

| ID | Requerimiento | CU | RN | Tests |
|----|--------------|----|----|-------|
| RF-001 | Generaci√≥n de Secuencia | CU-001, CU-002 | RN-001, RN-002, RN-003 | TC-001 a TC-004 |
| RF-002 | Visualizaci√≥n | CU-001, CU-002, CU-003 | - | TC-005 a TC-008 |
| RF-003 | Entrada Jugador | CU-002, CU-003 | - | TC-009 a TC-012 |
| RF-004 | Sistema Vidas | CU-003, CU-004 | - | TC-013 a TC-016 |
| RF-005 | Puntuaci√≥n | CU-002 | RN-004, RN-005, RN-006 | TC-017 a TC-020 |
| RF-006 | Perfect Streak | CU-002, CU-003 | RN-006 | TC-021 a TC-024 |
| RF-007 | High Scores | CU-002, CU-005 | RN-007, RN-008 | TC-025 a TC-028 |
| RF-008 | Toggle Coords | CU-006 | RN-008 | TC-029 a TC-032 |
| RF-009 | Toggle Sonido | CU-007 | RN-008 | TC-033 a TC-036 |
| RF-010 | Overlays | CU-002, CU-003, CU-004 | - | TC-037 a TC-040 |
| RF-011 | Responsive | Todos | - | TC-041 a TC-044 |
| RF-012 | Niveles | CU-001, CU-002 | RN-003 | TC-045 a TC-048 |

---

## 11. CRITERIOS DE ACEPTACI√ìN

### Criterios Generales

‚úÖ **CA-001:** Jugador puede completar nivel 1 sin errores
‚úÖ **CA-002:** Sistema muestra feedback visual en todas las interacciones
‚úÖ **CA-003:** Puntuaci√≥n se calcula correctamente seg√∫n f√≥rmula
‚úÖ **CA-004:** High scores persisten entre sesiones
‚úÖ **CA-005:** Juego es responsive en mobile y desktop
‚úÖ **CA-006:** Animaciones son fluidas (60fps)
‚úÖ **CA-007:** Sonidos son opcionales (toggle funciona)
‚úÖ **CA-008:** Coordenadas son opcionales (toggle funciona)
‚úÖ **CA-009:** Game Over muestra stats correctos
‚úÖ **CA-010:** Modo infinito funciona despu√©s de nivel 10

### Criterios de Calidad

‚úÖ **CC-001:** Lighthouse Performance > 90
‚úÖ **CC-002:** Lighthouse Accessibility > 90
‚úÖ **CC-003:** Lighthouse Best Practices > 90
‚úÖ **CC-004:** Lighthouse SEO > 90
‚úÖ **CC-005:** Sin errores en consola
‚úÖ **CC-006:** Sin warnings de performance
‚úÖ **CC-007:** Compatible con navegadores target
‚úÖ **CC-008:** Touch funciona en mobile

---

## 12. MEJORAS FUTURAS

> üí° **Esta secci√≥n es tu roadmap de desarrollo.** Cada mejora est√° priorizada y estimada. Puedes implementarlas en el orden que prefieras seg√∫n las necesidades del proyecto.

### 12.1 Sistema de Puntuaci√≥n - FASE 2 üèÜ

**Prioridad:** ‚≠ê‚≠ê‚≠ê Alta
**Estimaci√≥n:** 8 horas
**Dependencias:** Sistema de scoring actual (‚úÖ Implementado)

---

#### MF-001: Stats Overlay Completo

**Descripci√≥n:** Panel modal con estad√≠sticas detalladas del jugador.

**Funcionalidades:**
- Bot√≥n "üìä STATS" en header (junto a HOME, COMENZAR, SONIDO)
- Overlay modal que muestra:
  - üèÜ Top Score
  - üéØ Best Level
  - üî• Longest Streak
  - ‚ö° Fastest Level (nivel + tiempo)
  - üéÆ Total Games Played
  - üìä Average Level Reached
  - üéØ Accuracy % (aciertos/intentos totales)
- Bot√≥n "üóëÔ∏è Reset Stats" con confirmaci√≥n
- Bot√≥n "‚úñ Cerrar"

**Mockup UI:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìä Records Personales         [‚úñ] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üèÜ Mejor Puntuaci√≥n      1443     ‚îÇ
‚îÇ  üéØ Nivel M√°ximo           7       ‚îÇ
‚îÇ  üî• Racha M√°s Larga        7       ‚îÇ
‚îÇ  ‚ö° Nivel M√°s R√°pido   3 (1.43s)  ‚îÇ
‚îÇ  üéÆ Partidas Jugadas       12      ‚îÇ
‚îÇ  üìä Nivel Promedio         4.5     ‚îÇ
‚îÇ  üéØ Precisi√≥n            87.5%     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [üóëÔ∏è Resetear Records] [Cerrar]   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Implementaci√≥n:**
```javascript
// Agregar a gameState
sessionStats: {
  gamesPlayed: 0,
  totalAttempts: 0,
  successfulAttempts: 0,
  totalLevelsReached: 0
}

// Funci√≥n para mostrar overlay
function showStatsOverlay() {
  const overlay = document.getElementById('statsOverlay');

  // Poblar datos
  document.getElementById('statsTopScore').textContent =
    gameState.highScores.topScore;

  // Calcular accuracy
  const accuracy = gameState.sessionStats.totalAttempts > 0
    ? (gameState.sessionStats.successfulAttempts /
       gameState.sessionStats.totalAttempts * 100).toFixed(1)
    : 0;

  overlay.classList.remove('hidden');
}
```

**Tests:**
```
TMF-001: Bot√≥n STATS abre overlay
TMF-002: Todas las estad√≠sticas se muestran correctamente
TMF-003: Reset stats funciona y pide confirmaci√≥n
TMF-004: Accuracy se calcula correctamente
TMF-005: Overlay se cierra correctamente
```

**Archivos a modificar:**
- `index.html`: Agregar overlay HTML
- `game.js`: Funciones de stats y tracking
- `styles.css`: Estilos del overlay

---

#### MF-002: Animaciones de Bonus

**Descripci√≥n:** Feedback visual cuando se ganan speed bonus o streak multipliers.

**Funcionalidades:**
- Popup "+100 Speed Bonus!" al completar nivel r√°pido
- Popup "üî• Streak x5!" cuando alcanza nueva racha
- Animaci√≥n: Fade in + slide up + fade out (1s)
- Color dorado para speed bonus
- Color fuego (gradient naranja-rojo) para streak

**Mockup:**
```
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ  ‚ö° +100 SPEED   ‚îÇ
     ‚îÇ     BONUS!       ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚Üë slide up
```

**Implementaci√≥n:**
```javascript
function showBonusPopup(type, value) {
  const popup = document.createElement('div');
  popup.className = `bonus-popup ${type}`;

  if (type === 'speed') {
    popup.textContent = `‚ö° +${value} SPEED BONUS!`;
  } else if (type === 'streak') {
    popup.textContent = `üî• STREAK x${value}!`;
  }

  document.body.appendChild(popup);

  // Auto-remove despu√©s de animaci√≥n
  setTimeout(() => popup.remove(), 1000);
}

// Llamar en onLevelComplete()
if (speedBonus > 0) {
  showBonusPopup('speed', speedBonus);
}
if (streakMultiplier > 1.0) {
  showBonusPopup('streak', gameState.perfectStreak);
}
```

**CSS:**
```css
.bonus-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 2rem;
  font-weight: 900;
  padding: 1rem 2rem;
  border-radius: 12px;
  animation: bonusAppear 1s ease-out forwards;
  z-index: 9999;
  pointer-events: none;
}

.bonus-popup.speed {
  color: #FFD700;
  background: rgba(255, 215, 0, 0.1);
  border: 3px solid #FFD700;
  box-shadow: 0 0 30px #FFD700;
}

.bonus-popup.streak {
  background: linear-gradient(135deg, #ff6b00, #ff0000);
  color: white;
  box-shadow: 0 0 40px #ff6b00;
}

@keyframes bonusAppear {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.5);
  }
  20% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.1);
  }
  80% {
    opacity: 1;
    transform: translate(-50%, -60%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -80%) scale(0.9);
  }
}
```

**Tests:**
```
TMF-006: Popup aparece cuando hay speed bonus
TMF-007: Popup aparece cuando hay nuevo streak
TMF-008: Animaci√≥n es fluida
TMF-009: Texto muestra valor correcto
TMF-010: Popup se auto-elimina despu√©s de 1s
```

---

#### MF-003: Confeti Dorado para Records

**Descripci√≥n:** Confeti especial y mensaje cuando se rompe un record.

**Funcionalidades:**
- Confeti color dorado (#FFD700)
- 50 part√≠culas (m√°s que el normal de 30)
- Mensaje "üèÜ NEW RECORD!" prominente
- Duraci√≥n: 3s
- Se activa cuando `updateHighScores()` retorna `true`

**Implementaci√≥n:**
```javascript
// Modificar onLevelComplete()
const isNewRecord = updateHighScores(timeElapsed);
if (isNewRecord) {
  console.log('üéä ¬°NUEVO RECORD!');
  launchGoldenConfetti(50);
  showRecordMessage();
}

// Nueva funci√≥n
function launchGoldenConfetti(count) {
  const container = document.getElementById('confettiContainer');

  for (let i = 0; i < count; i++) {
    const confetti = document.createElement('div');
    confetti.className = 'confetti golden';
    confetti.style.left = `${Math.random() * window.innerWidth}px`;
    confetti.style.animationDelay = `${Math.random() * 0.5}s`;
    confetti.style.animationDuration = `${2 + Math.random()}s`;

    container.appendChild(confetti);

    setTimeout(() => confetti.remove(), 3000);
  }
}

function showRecordMessage() {
  const msg = document.createElement('div');
  msg.className = 'record-message';
  msg.textContent = 'üèÜ NEW RECORD!';
  document.body.appendChild(msg);

  setTimeout(() => msg.remove(), 2000);
}
```

**CSS:**
```css
.confetti.golden {
  background: linear-gradient(135deg, #FFD700, #FFA500);
  box-shadow: 0 0 10px #FFD700;
}

.record-message {
  position: fixed;
  top: 20%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 3rem;
  font-weight: 900;
  color: #FFD700;
  text-shadow:
    0 0 20px #FFD700,
    0 0 40px #FFA500,
    2px 2px 4px rgba(0,0,0,0.8);
  animation: recordPulse 2s ease-out;
  z-index: 9999;
  pointer-events: none;
}

@keyframes recordPulse {
  0%, 100% {
    opacity: 0;
    transform: translateX(-50%) scale(0.5);
  }
  10%, 90% {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
  50% {
    transform: translateX(-50%) scale(1.1);
  }
}
```

**Tests:**
```
TMF-011: Confeti dorado aparece en nuevo record
TMF-012: Mensaje "NEW RECORD" visible
TMF-013: Cantidad de confeti es mayor (50)
TMF-014: Duraci√≥n es 3s
```

---

### 12.2 Efectos Visuales - FASE 3 ‚ú®

**Prioridad:** ‚≠ê‚≠ê Media
**Estimaci√≥n:** 12 horas
**Dependencias:** Ninguna

---

#### MF-004: Trail/Camino Animado

**Descripci√≥n:** L√≠nea ne√≥n que conecta casillas durante la visualizaci√≥n de la secuencia.

**Funcionalidades:**
- SVG overlay sobre el tablero
- L√≠nea desde casilla anterior a casilla actual
- Color matching con el highlight
- Animaci√≥n stroke-dasharray (efecto dibujado)
- Fade out despu√©s de 500ms

**Implementaci√≥n:**
```javascript
// Agregar SVG al tablero
function createTrailSVG() {
  const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
  svg.id = 'trailOverlay';
  svg.style.position = 'absolute';
  svg.style.top = '0';
  svg.style.left = '0';
  svg.style.width = '100%';
  svg.style.height = '100%';
  svg.style.pointerEvents = 'none';
  svg.style.zIndex = '10';

  document.getElementById('chessboard').appendChild(svg);
}

// Dibujar l√≠nea entre casillas
function drawTrail(fromSquare, toSquare, color) {
  const svg = document.getElementById('trailOverlay');
  const fromEl = document.querySelector(`[data-square="${fromSquare}"]`);
  const toEl = document.querySelector(`[data-square="${toSquare}"]`);

  const fromRect = fromEl.getBoundingClientRect();
  const toRect = toEl.getBoundingClientRect();
  const svgRect = svg.getBoundingClientRect();

  const x1 = fromRect.left + fromRect.width/2 - svgRect.left;
  const y1 = fromRect.top + fromRect.height/2 - svgRect.top;
  const x2 = toRect.left + toRect.width/2 - svgRect.left;
  const y2 = toRect.top + toRect.height/2 - svgRect.top;

  const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
  line.setAttribute('x1', x1);
  line.setAttribute('y1', y1);
  line.setAttribute('x2', x2);
  line.setAttribute('y2', y2);
  line.setAttribute('stroke', color.hex);
  line.setAttribute('stroke-width', '4');
  line.classList.add('trail-line');

  svg.appendChild(line);

  // Fade out despu√©s de 500ms
  setTimeout(() => {
    line.style.opacity = '0';
    setTimeout(() => line.remove(), 300);
  }, 500);
}

// Modificar showSequence() para llamar drawTrail
for (let i = 0; i < gameState.sequence.length; i++) {
  // ... c√≥digo existente ...

  if (i > 0) {
    drawTrail(
      gameState.sequence[i-1],
      gameState.sequence[i],
      gameState.sequenceColors[i]
    );
  }
}
```

**CSS:**
```css
.trail-line {
  filter: drop-shadow(0 0 10px currentColor);
  stroke-dasharray: 10;
  stroke-linecap: round;
  opacity: 0.8;
  transition: opacity 0.3s ease-out;
  animation: trailDraw 0.3s ease-out;
}

@keyframes trailDraw {
  from {
    stroke-dashoffset: 100;
  }
  to {
    stroke-dashoffset: 0;
  }
}
```

**Tests:**
```
TMF-015: Trail aparece entre casillas consecutivas
TMF-016: Color coincide con highlight
TMF-017: Animaci√≥n es fluida
TMF-018: Trail desaparece despu√©s de 500ms
```

---

#### MF-005: Part√≠culas al Acertar

**Descripci√≥n:** Mini explosi√≥n de part√≠culas cuando el jugador hace clic correcto.

**Funcionalidades:**
- 5 part√≠culas peque√±as
- Color igual al highlight de la casilla
- Explotan desde el centro de la casilla
- Duraci√≥n: 800ms
- Direcciones aleatorias

**Implementaci√≥n:**
```javascript
function spawnParticles(squareElement, color, count = 5) {
  const rect = squareElement.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2;
  const centerY = rect.top + rect.height / 2;

  for (let i = 0; i < count; i++) {
    const particle = document.createElement('div');
    particle.className = 'success-particle';
    particle.style.left = `${centerX}px`;
    particle.style.top = `${centerY}px`;
    particle.style.background = color.hex;
    particle.style.boxShadow = `0 0 10px ${color.hex}`;

    // √Ångulo aleatorio
    const angle = (Math.random() * Math.PI * 2);
    const distance = 30 + Math.random() * 40;

    particle.style.setProperty('--tx', `${Math.cos(angle) * distance}px`);
    particle.style.setProperty('--ty', `${Math.sin(angle) * distance}px`);

    document.body.appendChild(particle);

    setTimeout(() => particle.remove(), 800);
  }
}

// Llamar en handleSquareClick() cuando isCorrect
if (isCorrect) {
  const color = gameState.sequenceColors[gameState.currentStep];
  highlightSquare(squareId, 500, color);
  spawnParticles(square, color, 5); // ‚Üê NUEVO

  // ... resto del c√≥digo ...
}
```

**CSS:**
```css
.success-particle {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  pointer-events: none;
  z-index: 9999;
  animation: particleExplode 0.8s ease-out forwards;
}

@keyframes particleExplode {
  0% {
    transform: translate(0, 0) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(var(--tx), var(--ty)) scale(0);
    opacity: 0;
  }
}
```

**Tests:**
```
TMF-019: Part√≠culas aparecen en click correcto
TMF-020: Color correcto seg√∫n casilla
TMF-021: No afecta performance (60fps mantenido)
TMF-022: Part√≠culas se auto-eliminan
```

---

#### MF-006: Tablero Celebra

**Descripci√≥n:** Animaci√≥n sutil del tablero completo al completar nivel.

**Funcionalidades:**
- Vibraci√≥n suave (rotate ¬±0.5deg)
- Scale ligero (1.02)
- Duraci√≥n: 500ms
- Se activa al completar nivel perfecto

**Implementaci√≥n:**
```javascript
// En onLevelComplete(), despu√©s del confeti
document.getElementById('chessboard').classList.add('celebrate');
setTimeout(() => {
  document.getElementById('chessboard').classList.remove('celebrate');
}, 500);
```

**CSS:**
```css
.chessboard.celebrate {
  animation: celebrate 0.5s ease-in-out;
}

@keyframes celebrate {
  0%, 100% {
    transform: scale(1) rotate(0deg);
  }
  25% {
    transform: scale(1.02) rotate(0.5deg);
  }
  50% {
    transform: scale(1.02) rotate(-0.5deg);
  }
  75% {
    transform: scale(1.02) rotate(0.5deg);
  }
}
```

**Tests:**
```
TMF-023: Tablero vibra al completar nivel
TMF-024: Animaci√≥n dura 500ms
TMF-025: Tablero vuelve a posici√≥n original
```

---

### 12.3 Modos de Juego - FASE 4 üéÆ

**Prioridad:** ‚≠ê‚≠ê Media
**Estimaci√≥n:** 16 horas
**Dependencias:** Ninguna

---

#### MF-007: Modo Zen

**Descripci√≥n:** Modo pr√°ctica sin presi√≥n de vidas.

**Funcionalidades:**
- Sin sistema de vidas (vidas infinitas)
- No hay game over
- Reintentos ilimitados
- Ideal para aprender y practicar
- Selector de modo en pantalla inicial

**UI del Selector:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Selecciona Modo de Juego:           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚öîÔ∏è  [NORMAL]    (5 vidas)           ‚îÇ
‚îÇ  üßò [ZEN]       (Sin vidas)          ‚îÇ
‚îÇ  ‚è±Ô∏è  [TIMED]     (Contra reloj)      ‚îÇ
‚îÇ  üí™ [CHALLENGE] (Experto)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Implementaci√≥n:**
```javascript
// Agregar a gameState
gameMode: 'normal', // 'normal' | 'zen' | 'timed' | 'challenge'

// Modificar onLevelFailed()
function onLevelFailed() {
  console.log('üíî Level failed');

  gameState.phase = 'fail';

  // En modo Zen, no restar vidas
  if (gameState.gameMode !== 'zen') {
    gameState.lives--;
  }

  gameState.currentLevelAttempts++;
  gameState.perfectStreak = 0;
  disableBoard();
  updateUI();

  // En modo Zen, nunca hay game over
  if (gameState.gameMode !== 'zen' && gameState.lives === 0) {
    gameOver();
    return;
  }

  showFailOverlay();
}

// Funci√≥n para seleccionar modo
function selectGameMode(mode) {
  gameState.gameMode = mode;
  localStorage.setItem('masterSequence_gameMode', mode);

  // Ajustar UI seg√∫n modo
  if (mode === 'zen') {
    document.getElementById('livesDisplay').textContent = '‚àû';
  }
}
```

**Tests:**
```
TMF-026: Modo Zen no resta vidas
TMF-027: No hay game over en modo Zen
TMF-028: Selector de modo funciona
TMF-029: Modo persiste en localStorage
```

---

#### MF-008: Modo Tiempo (Contra Reloj)

**Descripci√≥n:** Completar niveles antes de que se acabe el tiempo global.

**Funcionalidades:**
- Timer global: 60s iniciales
- +10s por nivel completado
- Game over cuando tiempo = 0
- Timer visible en header con animaci√≥n
- Barra de progreso de tiempo
- Sonido de alerta cuando quedan <10s

**UI:**
```
[Header]
[‚è±Ô∏è 45.2s] ‚Üê Timer grande y visible
[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë] ‚Üê Barra de progreso
```

**Implementaci√≥n:**
```javascript
// Agregar a gameState
timeRemaining: 60000, // 60s en ms
timerInterval: null,

// Iniciar timer
function startTimedMode() {
  gameState.timeRemaining = 60000;

  gameState.timerInterval = setInterval(() => {
    if (gameState.phase === 'playing' && gameState.gameMode === 'timed') {
      gameState.timeRemaining -= 100;

      if (gameState.timeRemaining <= 0) {
        clearInterval(gameState.timerInterval);
        gameOver('¬°Se acab√≥ el tiempo!');
      }

      updateTimerDisplay();

      // Alerta cuando quedan <10s
      if (gameState.timeRemaining <= 10000 && gameState.timeRemaining % 1000 < 100) {
        playBeep(880); // Sonido de alerta
      }
    }
  }, 100);
}

// Actualizar UI del timer
function updateTimerDisplay() {
  const seconds = (gameState.timeRemaining / 1000).toFixed(1);
  document.getElementById('timerDisplay').textContent = `‚è±Ô∏è ${seconds}s`;

  // Barra de progreso
  const percent = (gameState.timeRemaining / 60000) * 100;
  document.getElementById('timerBar').style.width = `${percent}%`;

  // Color de alerta
  if (gameState.timeRemaining < 10000) {
    document.getElementById('timerDisplay').style.color = 'var(--neon-red)';
  }
}

// Bonus de tiempo al completar nivel
function onLevelComplete() {
  // ... c√≥digo existente ...

  if (gameState.gameMode === 'timed') {
    gameState.timeRemaining += 10000; // +10s
    console.log('‚è±Ô∏è +10s bonus!');
  }
}
```

**CSS:**
```css
#timerDisplay {
  font-size: 2rem;
  font-weight: 900;
  color: var(--neon-cyan);
  transition: color 0.3s;
}

#timerBar {
  width: 100%;
  height: 8px;
  background: var(--neon-cyan);
  transition: width 0.1s linear;
  box-shadow: 0 0 10px var(--neon-cyan);
}
```

**Tests:**
```
TMF-030: Timer cuenta regresivo correctamente
TMF-031: Bonus +10s se suma al completar nivel
TMF-032: Game over cuando tiempo = 0
TMF-033: Alerta suena cuando quedan <10s
TMF-034: Barra de progreso se actualiza
```

---

#### MF-009: Modo Desaf√≠o (Challenge)

**Descripci√≥n:** Secuencias extra largas desde el inicio para jugadores expertos.

**Funcionalidades:**
- Nivel 1 empieza con 5 casillas
- Cada nivel +2 casillas (en vez de +1)
- Solo 1 vida
- Sin reintentos
- Records separados

**Progresi√≥n:**
```
Nivel 1: 5 casillas
Nivel 2: 7 casillas
Nivel 3: 9 casillas
Nivel 4: 11 casillas
...
```

**Implementaci√≥n:**
```javascript
// Modificar startLevel()
function startLevel(level) {
  console.log(`üìä Starting level ${level}...`);

  gameState.currentLevel = level;
  gameState.playerSequence = [];
  gameState.currentStep = 0;
  gameState.currentLevelAttempts = 0;

  // Ajustar vidas seg√∫n modo
  if (gameState.gameMode === 'challenge' && level === 1) {
    gameState.lives = 1;
    gameState.maxLives = 1;
  }

  // Generar secuencia seg√∫n modo
  let config = window.CoordinateSequence.Levels.getLevelConfig(level);

  if (gameState.gameMode === 'challenge') {
    config = { ...config };
    config.sequenceLength = 5 + ((level - 1) * 2); // 5, 7, 9, 11...
  }

  // ... resto del c√≥digo ...
}
```

**Tests:**
```
TMF-035: Nivel 1 tiene 5 casillas en modo Challenge
TMF-036: Incrementa de 2 en 2
TMF-037: Solo 1 vida
TMF-038: Game over al primer error
```

---

### 12.4 Ayudas/Power-ups - FASE 5 üí°

**Prioridad:** ‚≠ê Baja
**Estimaci√≥n:** 10 horas
**Dependencias:** Ninguna

---

#### MF-010: Hint (Mostrar Pr√≥xima Casilla)

**Descripci√≥n:** Ilumina la siguiente casilla correcta cuando est√°s atorado.

**Funcionalidades:**
- 3 hints por partida
- Pulsa la casilla correcta 3 veces (intervalo 400ms)
- Resta 50 puntos
- Rompe racha perfecta
- Bot√≥n en sidebar: "üí° Hint (3)"

**Implementaci√≥n:**
```javascript
// Agregar a gameState
hintsRemaining: 3,

// Funci√≥n de hint
function useHint() {
  if (gameState.hintsRemaining <= 0) {
    console.log('‚ùå No quedan hints');
    return;
  }

  if (gameState.phase !== 'playing') {
    console.log('‚ùå Hint solo disponible durante input');
    return;
  }

  const nextSquare = gameState.sequence[gameState.currentStep];
  const color = gameState.sequenceColors[gameState.currentStep];

  console.log(`üí° Hint: La siguiente casilla es ${nextSquare}`);

  // Pulsar 3 veces
  for (let i = 0; i < 3; i++) {
    setTimeout(() => {
      highlightSquare(nextSquare, 300, color);
      if (gameState.soundEnabled) {
        playBeep(880);
      }
    }, i * 400);
  }

  // Penalizaciones
  gameState.hintsRemaining--;
  gameState.score = Math.max(0, gameState.score - 50);
  gameState.perfectStreak = 0; // Rompe racha

  updateUI();
}
```

**UI:**
```html
<button class="btn-hint" id="btnHint">
  üí° <span id="hintCount">Hint (3)</span>
</button>
```

**Tests:**
```
TMF-039: Hint ilumina casilla correcta
TMF-040: Pulsa 3 veces
TMF-041: Contador decrementa
TMF-042: Resta 50 puntos
TMF-043: Rompe perfect streak
TMF-044: Deshabilitado cuando hints = 0
```

---

#### MF-011: Replay (Ver Secuencia de Nuevo)

**Descripci√≥n:** Volver a ver la secuencia durante la fase de input.

**Funcionalidades:**
- 2 replays por partida
- Resetea progreso del nivel actual
- No resta puntos
- No rompe streak (si no has cometido error a√∫n)
- Bot√≥n: "üîÑ Replay (2)"

**Implementaci√≥n:**
```javascript
// Agregar a gameState
replaysRemaining: 2,

// Funci√≥n replay
function useReplay() {
  if (gameState.replaysRemaining <= 0) {
    console.log('‚ùå No quedan replays');
    return;
  }

  if (gameState.phase !== 'playing') {
    console.log('‚ùå Replay solo disponible durante input');
    return;
  }

  console.log('üîÑ Replay: Mostrando secuencia de nuevo');

  // Resetear progreso del nivel
  gameState.playerSequence = [];
  gameState.currentStep = 0;
  gameState.phase = 'showing';

  gameState.replaysRemaining--;
  updateUI();

  // Mostrar secuencia
  setTimeout(() => showSequence(), 500);
}
```

**Tests:**
```
TMF-045: Replay muestra secuencia de nuevo
TMF-046: Resetea progreso del nivel
TMF-047: Contador decrementa
TMF-048: No resta puntos
TMF-049: No rompe streak si no hubo error previo
```

---

#### MF-012: Slow Motion

**Descripci√≥n:** Visualizaci√≥n m√°s lenta para niveles dif√≠ciles.

**Funcionalidades:**
- 1 uso por partida
- Duplica duraci√≥n de highlight y pause
- Auto-activa despu√©s de 2 fallos consecutivos en un nivel
- Bot√≥n: "üêå Slow Motion (1)"

**Implementaci√≥n:**
```javascript
// Agregar a gameState
slowMotionAvailable: true,
slowMotionActive: false,

// Funci√≥n slow motion
function useSlowMotion() {
  if (!gameState.slowMotionAvailable) {
    console.log('‚ùå Slow motion ya usado');
    return;
  }

  console.log('üêå Slow Motion activado');
  gameState.slowMotionActive = true;
  gameState.slowMotionAvailable = false;
  updateUI();
}

// Modificar showSequence()
async function showSequence() {
  // ... c√≥digo existente ...

  let highlightDuration = config.highlightDuration;
  let pauseDuration = config.pauseDuration;

  // Duplicar tiempos en slow motion
  if (gameState.slowMotionActive) {
    highlightDuration *= 2;
    pauseDuration *= 2;
  }

  // ... resto del c√≥digo con los tiempos modificados ...

  // Resetear slow motion despu√©s de mostrar
  gameState.slowMotionActive = false;
}

// Auto-activar despu√©s de 2 fallos
function onLevelFailed() {
  // ... c√≥digo existente ...

  if (gameState.currentLevelAttempts >= 2 && gameState.slowMotionAvailable) {
    console.log('üêå Auto-activando Slow Motion...');
    useSlowMotion();
  }
}
```

**Tests:**
```
TMF-050: Slow motion duplica tiempos
TMF-051: Auto-activa despu√©s de 2 fallos
TMF-052: Solo 1 uso por partida
TMF-053: Bot√≥n se deshabilita despu√©s de usar
```

---

### 12.5 Audio Mejorado - FASE 6 üîä

**Prioridad:** ‚≠ê Baja
**Estimaci√≥n:** 6 horas
**Dependencias:** Sistema de audio actual

---

#### MF-013: Notas Musicales por Color

**Descripci√≥n:** Cada color tiene una nota musical diferente, creando melod√≠as.

**Mapping de Notas:**
```javascript
const COLOR_NOTES = {
  cyan:    261.63,  // C4 (Do)
  magenta: 293.66,  // D4 (Re)
  green:   329.63,  // E4 (Mi)
  orange:  349.23,  // F4 (Fa)
  purple:  392.00,  // G4 (Sol)
  yellow:  440.00,  // A4 (La)
  pink:    493.88,  // B4 (Si)
  lime:    523.25   // C5 (Do alto)
};
```

**Implementaci√≥n:**
```javascript
// Modificar showSequence() en game.js
for (let i = 0; i < gameState.sequence.length; i++) {
  const square = gameState.sequence[i];
  const color = gameState.sequenceColors[i];

  await highlightSquare(square, highlightDuration, color);

  // Reproducir nota seg√∫n color
  if (gameState.soundEnabled && typeof playNote === 'function') {
    const frequency = COLOR_NOTES[color.name];
    playNote(frequency, highlightDuration * 0.8);
  }

  // ... resto del c√≥digo ...
}

// Agregar a audio.js
function playNote(frequency, duration) {
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();

  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);

  oscillator.frequency.value = frequency;
  oscillator.type = 'sine'; // Tono suave

  // Envelope (ataque y release)
  gainNode.gain.setValueAtTime(0, audioContext.currentTime);
  gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.01);
  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);

  oscillator.start(audioContext.currentTime);
  oscillator.stop(audioContext.currentTime + duration / 1000);
}
```

**Resultado:**
- Cada secuencia crea una melod√≠a √∫nica
- Ayuda a la memoria auditiva
- M√°s musical e interesante

**Tests:**
```
TMF-054: Cada color reproduce nota diferente
TMF-055: Notas se sincronizan con highlights
TMF-056: Melod√≠a es agradable al o√≠do
TMF-057: Toggle de sonido afecta las notas
```

---

#### MF-014: Melod√≠a de Victoria

**Descripci√≥n:** Arpeggio ascendente al completar nivel.

**Implementaci√≥n:**
```javascript
// Agregar a audio.js
function playVictoryJingle() {
  const notes = [
    261.63,  // C4
    329.63,  // E4
    392.00,  // G4
    523.25   // C5
  ];

  notes.forEach((freq, i) => {
    setTimeout(() => {
      playNote(freq, 200);
    }, i * 150);
  });
}

// Llamar en onLevelComplete()
if (gameState.soundEnabled && typeof playVictoryJingle === 'function') {
  playVictoryJingle();
}
```

**Tests:**
```
TMF-058: Melod√≠a se reproduce al completar nivel
TMF-059: Notas son Do-Mi-Sol-Do
TMF-060: Timing es correcto (150ms entre notas)
```

---

#### MF-015: Sonidos Rey vs Caballo

**Descripci√≥n:** Diferentes efectos seg√∫n si el movimiento es de rey o caballo.

**Implementaci√≥n:**
```javascript
// En showSequence(), despu√©s de highlight
if (i > 0 && gameState.soundEnabled) {
  const prevSquare = gameState.sequence[i - 1];
  const currSquare = gameState.sequence[i];

  const isKing = window.ChessGameLibrary.BoardUtils.isKingMove(prevSquare, currSquare);
  const isKnight = window.ChessGameLibrary.BoardUtils.isKnightMove(prevSquare, currSquare);

  if (isKing) {
    playNote(440, 100); // Tono corto (La)
  } else if (isKnight) {
    playNote(880, 100); // Tono alto, doble frecuencia (La alto)
  }
}
```

**Tests:**
```
TMF-061: Movimiento rey reproduce tono bajo
TMF-062: Movimiento caballo reproduce tono alto
TMF-063: Sonidos ayudan a identificar tipo de movimiento
```

---

### 12.6 Tutorial Interactivo - FASE 7 üìö

**Prioridad:** ‚≠ê Baja
**Estimaci√≥n:** 8 horas
**Dependencias:** Ninguna

---

#### MF-016: Tutorial Paso a Paso

**Descripci√≥n:** Gu√≠a interactiva para jugadores nuevos.

**Pasos del Tutorial:**

1. **Bienvenida**
   - "¬°Bienvenido a Master Sequence!"
   - Explicaci√≥n breve del concepto

2. **Objetivo**
   - "Observa la secuencia iluminada"
   - "Rep√≠tela en el mismo orden"
   - Ejemplo animado

3. **Movimientos**
   - "Las secuencias siguen movimientos de ajedrez"
   - Diagrama de movimiento rey y caballo
   - "Esto hace los patrones m√°s naturales"

4. **Colores**
   - "Cada casilla tiene su color √∫nico"
   - "¬°√ösalos para ayudarte a recordar!"
   - Muestra paleta de colores

5. **Pr√°ctica Guiada**
   - Secuencia simple: e4 ‚Üí e5
   - Flechas apuntando
   - "¬°Ahora t√∫!"

6. **Listo**
   - "¬°Perfecto! Ahora est√°s listo"
   - "¬øSaltar tutorial en el futuro?"
   - [S√≠] [No]

**Implementaci√≥n:**
```javascript
// localStorage
tutorialCompleted: false,
skipTutorial: false,

// Al cargar juego
if (!tutorialCompleted && !skipTutorial) {
  showTutorial();
}

// Funci√≥n tutorial
function showTutorial() {
  const steps = [
    {
      title: "¬°Bienvenido!",
      content: "Master Sequence es un juego de memoria basado en ajedrez.",
      button: "Siguiente"
    },
    {
      title: "Objetivo",
      content: "Observa la secuencia de casillas iluminadas y rep√≠tela exactamente.",
      demo: true,
      button: "Siguiente"
    },
    // ... m√°s pasos
  ];

  showTutorialOverlay(steps);
}
```

**Tests:**
```
TMF-064: Tutorial aparece para usuario nuevo
TMF-065: Todos los pasos se muestran
TMF-066: Pr√°ctica guiada funciona
TMF-067: Opci√≥n skip persiste
```

---

### 12.7 Estad√≠sticas Avanzadas - FASE 8 üìä

**Prioridad:** ‚≠ê Baja
**Estimaci√≥n:** 6 horas
**Dependencias:** MF-001 (Stats Overlay)

---

#### MF-017: Tracking de Sesi√≥n

**M√©tricas a Agregar:**
- Tiempo total jugado (minutos)
- Niveles completados en sesi√≥n
- Intentos totales
- Precisi√≥n % en sesi√≥n

#### MF-018: Estad√≠sticas Hist√≥ricas

**M√©tricas:**
- Partidas jugadas totales
- Tiempo total acumulado
- Promedio de nivel alcanzado
- Tendencia de mejora (gr√°fica)

---

### 12.8 Mejoras de UX - FASE 9 üé®

**Prioridad:** ‚≠ê Baja
**Estimaci√≥n:** 4 horas

---

#### MF-019: Preview de Nivel

**Descripci√≥n:** Mostrar info del siguiente nivel antes de empezar.

**Contenido:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìä NIVEL 5                ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ  Secuencia: 5 casillas     ‚îÇ
‚îÇ  √Årea: Ring 4x4            ‚îÇ
‚îÇ  Tiempo rec: 9.5s          ‚îÇ
‚îÇ                            ‚îÇ
‚îÇ  [Comenzar] [Saltar]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

#### MF-020: Pausa Durante Juego

**Descripci√≥n:** Bot√≥n de pausa durante fase de input.

**Funcionalidad:**
- Pausa timer
- Deshabilita tablero
- Overlay con opciones:
  - Continuar
  - Reintentar nivel
  - Salir al men√∫

---

### 12.9 Accesibilidad - FASE 10 ‚ôø

**Prioridad:** ‚≠ê‚≠ê Media
**Estimaci√≥n:** 8 horas

---

#### MF-021: Navegaci√≥n por Teclado

**Controles:**
- Flechas: Mover cursor en tablero
- Enter/Space: Seleccionar casilla
- ESC: Cerrar overlay
- Tab: Navegaci√≥n entre botones
- P: Pausa

---

#### MF-022: Modo Alto Contraste

**Caracter√≠sticas:**
- Fondos m√°s oscuros
- Bordes m√°s gruesos (5px en vez de 3px)
- Texto m√°s grande (+20%)
- Toggle en settings

---

#### MF-023: Screen Reader Support

**Implementaci√≥n:**
- ARIA labels completos
- Anuncios de estado (`aria-live`)
- Descripci√≥n de secuencia en texto
- Feedback textual de todas las acciones

---

### 12.10 Social Features - FASE 11 üåê

**Prioridad:** ‚≠ê Baja
**Estimaci√≥n:** 20 horas
**Dependencias:** Backend (fuera de alcance actual)

---

#### MF-024: Compartir Score

**Descripci√≥n:** Compartir puntuaci√≥n en redes sociales.

**Plataformas:**
- Twitter
- Facebook
- WhatsApp
- Clipboard (copiar)

**Formato del Mensaje:**
```
üü¶ Master Sequence - ChessArcade

üèÜ Level 7 | Score: 1443
üî• Streak: 7x perfect
‚ö° ¬øPuedes superarme?

[Play Now] ‚Üí chessarcade.com.ar
```

**Implementaci√≥n:**
```javascript
function shareScore() {
  const text = `üü¶ Master Sequence - ChessArcade

üèÜ Level ${gameState.currentLevel} | Score: ${gameState.score}
üî• Streak: ${gameState.perfectStreak}x perfect
‚ö° ¬øPuedes superarme?

Play: https://chessarcade.com.ar`;

  // Twitter
  const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;

  // Clipboard
  navigator.clipboard.writeText(text);
}
```

---

#### MF-025: Leaderboard Global

**Descripci√≥n:** Ranking mundial de jugadores.

**Requisitos:**
- Backend con base de datos
- Sistema de autenticaci√≥n
- API para scores
- Filtros: Diario, Semanal, All-Time

**Fuera de alcance v1.x** (requiere infraestructura)

---

#### MF-026: Desaf√≠os Diarios

**Descripci√≥n:** Secuencia espec√≠fica cada d√≠a, igual para todos.

**Caracter√≠sticas:**
- Seed diario para generar misma secuencia
- 1 intento por d√≠a
- Leaderboard espec√≠fico del d√≠a
- Recompensas especiales (badges)

**Fuera de alcance v1.x** (requiere backend)

---

## 13. GLOSARIO

**T√©rminos del Juego:**

| T√©rmino | Definici√≥n |
|---------|------------|
| **Secuencia Acumulativa** | Lista de casillas que crece en cada nivel agregando una nueva |
| **Perfect Streak** | Cantidad de niveles completados sin errores consecutivos |
| **Speed Bonus** | Puntos extra por completar nivel r√°pido |
| **Streak Multiplier** | Multiplicador aplicado por racha perfecta |
| **High Score** | Mejor puntuaci√≥n hist√≥rica del jugador |
| **Master Sequence** | Secuencia completa acumulativa de toda la partida |
| **Square Usage Count** | Contador de veces que se us√≥ cada casilla |
| **Highlight** | Iluminaci√≥n de una casilla con color ne√≥n |
| **Overlay** | Pantalla modal sobre el juego |
| **localStorage** | Almacenamiento local del navegador |
| **Power-up** | Ayuda especial (Hint, Replay, Slow Motion) |
| **Game Mode** | Variante de juego (Normal, Zen, Timed, Challenge) |

**T√©rminos de Ajedrez:**

| T√©rmino | Definici√≥n |
|---------|------------|
| **Casilla** | Cada uno de los 64 cuadrados del tablero |
| **Notaci√≥n Algebraica** | Sistema de coordenadas (a1-h8) |
| **Movimiento Rey** | 1 casilla en cualquier direcci√≥n (8 opciones) |
| **Movimiento Caballo** | Movimiento en L (2+1 o 1+2) |
| **Distancia Chebyshev** | M√°xima diferencia en coordenadas X o Y |
| **Fila (Rank)** | L√≠nea horizontal (1-8) |
| **Columna (File)** | L√≠nea vertical (a-h) |
| **Cuadrante** | Una de las 4 secciones del tablero |
| **Ring** | Anillo de casillas desde el centro |

**T√©rminos T√©cnicos:**

| T√©rmino | Definici√≥n |
|---------|------------|
| **Web Audio API** | API del navegador para audio sint√©tico |
| **localStorage** | Almacenamiento persistente del navegador |
| **Responsive** | Adaptable a diferentes tama√±os de pantalla |
| **60fps** | 60 cuadros por segundo (animaci√≥n fluida) |
| **WCAG** | Web Content Accessibility Guidelines |
| **ARIA** | Accessible Rich Internet Applications |
| **Breakpoint** | Ancho de pantalla donde cambia el layout |
| **SVG** | Scalable Vector Graphics (gr√°ficos vectoriales) |
| **Confeti** | Part√≠culas animadas de celebraci√≥n |
| **Trail** | L√≠nea que conecta casillas en secuencia |

---

## üìù CONTROL DE CAMBIOS

| Versi√≥n | Fecha | Cambios | Autor |
|---------|-------|---------|-------|
| 1.0.0 | 2025-01-16 | Documento inicial | ChessArcade Team |
| 1.1.0 | 2025-10-17 | Sistema puntuaci√≥n mejorado | ChessArcade Team |
| 1.2.0 | 2025-10-17 | Vidas a 5, UX Game Over, ERS completo | ChessArcade Team |

---

## üìß CONTACTO Y APROBACIONES

**Stakeholder:** ChessArcade Team
**Product Owner:** [Nombre]
**Tech Lead:** Claude Code
**QA Lead:** [Nombre]

**Aprobaciones Requeridas:**
- [ ] Product Owner
- [ ] Tech Lead
- [ ] UX Designer
- [ ] QA Lead

---

## üìå NOTAS FINALES

### C√≥mo Usar Este Documento

**Para Desarrolladores:**
- Secci√≥n 4 (RF) para implementar features
- Secci√≥n 6 (CU) para entender flujos
- Secci√≥n 12 (Mejoras Futuras) para planificar sprints

**Para QA:**
- Secci√≥n 11 (Criterios) para casos de prueba
- Secci√≥n 10 (Matriz) para trazabilidad
- Tests espec√≠ficos en cada RF

**Para Stakeholders:**
- Secci√≥n 2 (Alcance) para entender qu√© est√° incluido
- Secci√≥n 12 (Mejoras) para roadmap
- Secci√≥n 11 (Criterios) para validar calidad

**Para Product Owners:**
- Secci√≥n 12 (Mejoras) para priorizar backlog
- Estimaciones de tiempo incluidas
- Dependencias claramente marcadas

### Mantenimiento del Documento

Este documento debe actualizarse cuando:
- Se implementa una nueva feature (mover de MF a RF)
- Cambian reglas de negocio
- Se agregan nuevos casos de uso
- Se modifican criterios de aceptaci√≥n
- Se priorizan nuevas mejoras

**Responsable de Actualizaci√≥n:** Tech Lead

---

**Fin del Documento**

*Este documento es un artefacto vivo y debe actualizarse con cada cambio significativo en los requerimientos.*

---

**üìö Documentos Relacionados:**
- `DESIGN.md` - Especificaci√≥n de dise√±o t√©cnico
- `CHANGELOG.md` - Historial de cambios
- `MEJORAS_PLANIFICADAS.md` - Backlog original
- `PROGRESO_SESION_MASTER_SEQUENCE.md` - Documentaci√≥n de implementaci√≥n

**üîó Enlaces √ötiles:**
- Repositorio: https://github.com/fasmote/ChessArcade
- Demo: https://chessarcade.com.ar
- Documentaci√≥n: `/games/coordinate-sequence/docs/`
