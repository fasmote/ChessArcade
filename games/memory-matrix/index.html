<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Matrix - ChessArcade</title>

    <!-- Estilos externos: ChessBoard2 library -->
    <link rel="stylesheet" href="libs/chessboard2.css">

    <!-- Estilos de ChessGameLibrary: Selector de temas de piezas -->
    <link rel="stylesheet" href="ChessGameLibrary/UI/ThemeSelector.css">

    <!-- Estilos del juego: Memory Matrix (arquitectura completa) -->
    <link rel="stylesheet" href="memory-matrix.css">
</head>
<body>
    <div class="game-container">

        <!-- ============================================
             HEADER: TÃ­tulo y botÃ³n principal
             ============================================ -->
        <div class="header">
            <h1>ðŸ§  Memory Matrix</h1>
            <button id="startBtn" class="btn-primary">Comenzar</button>
        </div>

        <!-- ============================================
             THEME SELECTOR: Cambiar estilo de piezas
             Este contenedor serÃ¡ llenado por ThemeSelector.js
             ============================================ -->
        <div id="theme-selector-container"></div>

        <!-- ============================================
             GAME AREA: Tablero + Banco de piezas
             Layout CSS Grid responsive
             ============================================ -->
        <div class="game-area">

            <!-- SecciÃ³n del tablero de ajedrez -->
            <div class="board-section">
                <!-- Este div serÃ¡ transformado en tablero por ChessBoard2.js -->
                <div id="chessboard"></div>
            </div>

            <!-- SecciÃ³n del banco de piezas draggables -->
            <div class="pieces-section">
                <h3>Coloca las piezas:</h3>
                <!-- Este div contendrÃ¡ las piezas que el jugador puede arrastrar -->
                <div id="piece-bank"></div>
            </div>

        </div>

        <!-- ============================================
             STATUS: Mensajes de estado del juego
             ============================================ -->
        <div class="status">
            <p id="status-text">Haz clic en "Comenzar" para empezar</p>
        </div>

    </div>

    <!-- ============================================
         LIBRERÃAS EXTERNAS
         ============================================ -->

    <!-- Chess.js: LÃ³gica de ajedrez, validaciÃ³n de movimientos, FEN, etc. -->
    <script src="libs/chess.min.js"></script>

    <!-- ChessBoard2.js: Renderizado visual del tablero de ajedrez -->
    <script src="libs/chessboard2.min.js"></script>

    <!-- ============================================
         CHESSGAMELIBRARY - CORE
         Sistema central de comunicaciÃ³n y estados
         ============================================ -->

    <!-- EventBus: Sistema pub/sub para comunicaciÃ³n entre mÃ³dulos
         Ejemplo: ThemeSelector emite 'themeChanged' â†’ BoardManager escucha y recarga -->
    <script src="ChessGameLibrary/Core/EventBus.js"></script>

    <!-- StateManager: GestiÃ³n de estados del juego
         Estados: waiting â†’ memorizing â†’ placing â†’ complete -->
    <script src="ChessGameLibrary/Core/StateManager.js"></script>

    <!-- ============================================
         CHESSGAMELIBRARY - CONFIG
         Configuraciones globales
         ============================================ -->

    <!-- PieceThemes: ConfiguraciÃ³n de temas de piezas
         Define: Lichess, Chess.com, Wikipedia, Monsters (MAG), etc.
         Maneja persistencia en localStorage -->
    <script src="ChessGameLibrary/Config/PieceThemes.js"></script>

    <!-- ============================================
         CHESSGAMELIBRARY - COMPONENTS
         Componentes reutilizables del juego
         ============================================ -->

    <!-- BoardManager: Wrapper de ChessBoard2.js
         - Inicializa tablero
         - Maneja posiciones (setPosition, getPosition, clear)
         - Escucha cambios de tema y recarga automÃ¡ticamente -->
    <script src="ChessGameLibrary/Board/BoardManager.js"></script>

    <!-- PieceBank: GestiÃ³n del banco lateral de piezas
         - Crea piezas draggables
         - Usa tema dinÃ¡mico (PieceThemes)
         - Remueve piezas cuando se colocan en tablero -->
    <script src="ChessGameLibrary/Pieces/PieceBank.js"></script>

    <!-- ============================================
         CHESSGAMELIBRARY - UI
         Componentes de interfaz de usuario
         ============================================ -->

    <!-- ThemeSelector: Selector visual de temas de piezas
         - Dropdown con preview de cada tema
         - Persistencia en localStorage
         - Emite evento 'themeChanged' al cambiar -->
    <script src="ChessGameLibrary/UI/ThemeSelector.js"></script>

    <!-- ============================================
         CHESSGAMELIBRARY - GAME LOGIC
         LÃ³gica especÃ­fica del juego Memory Matrix
         ============================================ -->

    <!-- MemoryLevels: Base de datos de 30 niveles
         - FENs de posiciones de Lichess
         - Partidas inmortales (Anderssen, Morphy, Fischer, Kasparov)
         - Finales artÃ­sticos (RÃ©ti, Saavedra, Lucena, Philidor)
         - Metadatos: dificultad, tiempo, piezas a memorizar -->
    <script src="ChessGameLibrary/Games/MemoryMatrix/MemoryLevels.js"></script>

    <!-- MemoryMatrixGame: Orquestador principal del juego
         - Conecta todos los componentes
         - Maneja flujo: memorizar â†’ ocultar â†’ colocar â†’ verificar
         - Drag & drop con detecciÃ³n de casilla exacta
         - VerificaciÃ³n de victoria -->
    <script src="ChessGameLibrary/Games/MemoryMatrix/MemoryMatrixGame.js"></script>

    <!-- ============================================
         GAME INITIALIZATION
         CÃ³digo de inicializaciÃ³n cuando el DOM estÃ© listo
         ============================================ -->
    <script>
        // Variable global para acceder al juego desde consola (Ãºtil para debugging)
        let memoryMatrixGame;

        // Esperar a que el DOM estÃ© completamente cargado
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ðŸ“„ DOM cargado, inicializando Memory Matrix...');

            // ==========================================
            // 1. INICIALIZAR SELECTOR DE TEMAS
            // ==========================================
            const themeSelector = new ThemeSelector('theme-selector-container', {
                position: 'top-right',      // PosiciÃ³n: esquina superior derecha
                showLabels: true,           // Mostrar texto "Piezas" en botÃ³n
                showDescriptions: false,    // No mostrar descripciones largas
                autoClose: true             // Cerrar dropdown al seleccionar
            });
            themeSelector.render();
            console.log('âœ… ThemeSelector inicializado');

            // ==========================================
            // 2. CREAR INSTANCIA DEL JUEGO
            // ==========================================
            // MemoryMatrixGame conecta automÃ¡ticamente:
            // - BoardManager (tablero)
            // - PieceBank (banco de piezas)
            // - StateManager (estados del juego)
            // - EventBus (comunicaciÃ³n entre componentes)
            memoryMatrixGame = new MemoryMatrixGame();

            // ==========================================
            // 3. INICIALIZAR EL JUEGO
            // ==========================================
            // Esto:
            // - Inicializa el tablero (ChessBoard2)
            // - Configura event listeners
            // - Establece estado inicial: 'waiting'
            // - Configura drag & drop desde banco al tablero
            memoryMatrixGame.initialize();

            console.log('âœ… Memory Matrix inicializado correctamente');
            console.log('ðŸ’¡ Tip: Accede al juego desde consola con "memoryMatrixGame"');
        });
    </script>
</body>
</html>